{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../generated/prisma/client'\n\nconst connectionString = `${process.env.DATABASE_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,yKAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,sJAAY,CAAC;IAAE;AAAQ"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/api/customers/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport async function GET(request: Request) {\r\n    const { searchParams } = new URL(request.url);\r\n    const userId = searchParams.get('userId');\r\n    const search = searchParams.get('search');\r\n\r\n    try {\r\n        const where = {\r\n            createdBy: userId || undefined,\r\n            ...(search && {\r\n                OR: [\r\n                    { name: { contains: search, mode: \"insensitive\" } },\r\n                    { email: { contains: search, mode: \"insensitive\" } },\r\n                ],\r\n            }),\r\n        };\r\n\r\n        const customers = await prisma.customer.findMany({\r\n            where,\r\n            include: {\r\n                sales: true,\r\n            },\r\n            orderBy: { createdAt: 'desc' },\r\n        });\r\n\r\n        return NextResponse.json({ customers });\r\n    } catch (error) {\r\n        console.error(error);\r\n        return NextResponse.json({ error: 'Failed to fetch customers' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: Request) {\r\n    try {\r\n        const { name, email, phone, country, city, userId } = await request.json();\r\n\r\n        // Basic validation\r\n        if (!name || !email || !phone || !country || !city || !userId) {\r\n            return NextResponse.json(\r\n                { error: 'Missing required fields: name, email, phone, country, city, or userId.' },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        // Check for unique email\r\n        const existingCustomer = await prisma.customer.findUnique({ where: { email } });\r\n        if (existingCustomer) {\r\n            return NextResponse.json({ error: 'Email already exists.' }, { status: 409 });\r\n        }\r\n\r\n        const customer = await prisma.customer.create({\r\n            data: {\r\n                name,\r\n                email,\r\n                phone,\r\n                country,\r\n                city,\r\n                createdBy: userId,\r\n            },\r\n        });\r\n\r\n        return NextResponse.json(customer, { status: 201 });\r\n    } catch (error) {\r\n        console.error(error);\r\n        return NextResponse.json({ error: 'Failed to create customer' }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAEO,eAAe,IAAI,OAAgB;IACtC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;IAChC,MAAM,SAAS,aAAa,GAAG,CAAC;IAEhC,IAAI;QACA,MAAM,QAAQ;YACV,WAAW,UAAU;YACrB,GAAI,UAAU;gBACV,IAAI;oBACA;wBAAE,MAAM;4BAAE,UAAU;4BAAQ,MAAM;wBAAc;oBAAE;oBAClD;wBAAE,OAAO;4BAAE,UAAU;4BAAQ,MAAM;wBAAc;oBAAE;iBACtD;YACL,CAAC;QACL;QAEA,MAAM,YAAY,MAAM,gIAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;YAC7C;YACA,SAAS;gBACL,OAAO;YACX;YACA,SAAS;gBAAE,WAAW;YAAO;QACjC;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAU;IACzC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ;AAEO,eAAe,KAAK,OAAgB;IACvC,IAAI;QACA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QAExE,mBAAmB;QACnB,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,SAAS,CAAC,WAAW,CAAC,QAAQ,CAAC,QAAQ;YAC3D,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAyE,GAClF;gBAAE,QAAQ;YAAI;QAEtB;QAEA,yBAAyB;QACzB,MAAM,mBAAmB,MAAM,gIAAM,CAAC,QAAQ,CAAC,UAAU,CAAC;YAAE,OAAO;gBAAE;YAAM;QAAE;QAC7E,IAAI,kBAAkB;YAClB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,WAAW,MAAM,gIAAM,CAAC,QAAQ,CAAC,MAAM,CAAC;YAC1C,MAAM;gBACF;gBACA;gBACA;gBACA;gBACA;gBACA,WAAW;YACf;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC,UAAU;YAAE,QAAQ;QAAI;IACrD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4B,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ"}}]
}