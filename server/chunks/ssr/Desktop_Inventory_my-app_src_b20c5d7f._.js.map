{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/reports/stockReport.ts"],"sourcesContent":["// lib/reports.ts\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport type StockReportRow = {\r\n    productName: string;\r\n    location: string;\r\n    openingStock: number;\r\n    production: number;\r\n    ibtReceived: number;\r\n    ibtIssued: number;\r\n    rebagGain: number;\r\n    damaged: number;\r\n    expired: number;\r\n    returns: number;\r\n    salesQty: number;\r\n    closingStock: number;\r\n};\r\n\r\nexport async function getStockReport(): Promise<StockReportRow[]> {\r\n    // Fetch all inventories with product and location\r\n    const inventories = await prisma.inventory.findMany({\r\n        include: {\r\n            product: {\r\n                include: {\r\n                    productions: true,\r\n                    adjustments: true,\r\n                    transfers: true,\r\n                    sales: true,\r\n                },\r\n            },\r\n            location: true,\r\n        },\r\n    });\r\n\r\n    // Build report row by row\r\n    const report = inventories.map((inv) => {\r\n        const product = inv.product;\r\n        const location = inv.location;\r\n\r\n        // Opening stock is current inventory quantity\r\n        const openingStock = inv.quantity;\r\n\r\n        // Production received\r\n        const production = product.productions.reduce((acc, p) => acc + p.quantity, 0);\r\n\r\n        // IBT (Internal Transfers)\r\n        const ibtIssued = product.transfers\r\n            .filter((t) => t.fromLocationId === location.id)\r\n            .reduce((acc, t) => acc + t.quantity, 0);\r\n\r\n        const ibtReceived = product.transfers\r\n            .filter((t) => t.toLocationId === location.id)\r\n            .reduce((acc, t) => acc + t.quantity, 0);\r\n\r\n        // Adjustments\r\n        const rebagGain = product.adjustments\r\n            .filter((a) => a.locationId === location.id && a.type === \"REBAG_GAIN\")\r\n            .reduce((acc, a) => acc + a.quantity, 0);\r\n\r\n        const damaged = product.adjustments\r\n            .filter((a) => a.locationId === location.id && a.type === \"DAMAGED\")\r\n            .reduce((acc, a) => acc + a.quantity, 0);\r\n\r\n        const expired = product.adjustments\r\n            .filter((a) => a.locationId === location.id && a.type === \"EXPIRED\")\r\n            .reduce((acc, a) => acc + a.quantity, 0);\r\n\r\n        // Sales\r\n        const salesQty = product.sales\r\n            .filter((s) => s.locationId === location.id && !s.isReturn)\r\n            .reduce((acc, s) => acc + s.quantity, 0);\r\n\r\n        const returns = product.sales\r\n            .filter((s) => s.locationId === location.id && s.isReturn)\r\n            .reduce((acc, s) => acc + s.quantity, 0);\r\n\r\n        // Closing stock\r\n        const closingStock =\r\n            openingStock +\r\n            production +\r\n            ibtReceived +\r\n            rebagGain +\r\n            returns -\r\n            ibtIssued -\r\n            salesQty -\r\n            damaged -\r\n            expired;\r\n\r\n        return {\r\n            productName: product.name,\r\n            location: location.name,\r\n            openingStock,\r\n            production,\r\n            ibtReceived,\r\n            ibtIssued,\r\n            rebagGain,\r\n            damaged,\r\n            expired,\r\n            returns,\r\n            salesQty,\r\n            closingStock,\r\n        };\r\n    });\r\n\r\n    return report;\r\n}\r\n"],"names":[],"mappings":"AAAA,iBAAiB;;;;;AACjB;;;;;;AAiBO,eAAe;IAClB,kDAAkD;IAClD,MAAM,cAAc,MAAM,mKAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;QAChD,SAAS;YACL,SAAS;gBACL,SAAS;oBACL,aAAa;oBACb,aAAa;oBACb,WAAW;oBACX,OAAO;gBACX;YACJ;YACA,UAAU;QACd;IACJ;IAEA,0BAA0B;IAC1B,MAAM,SAAS,YAAY,GAAG,CAAC,CAAC;QAC5B,MAAM,UAAU,IAAI,OAAO;QAC3B,MAAM,WAAW,IAAI,QAAQ;QAE7B,8CAA8C;QAC9C,MAAM,eAAe,IAAI,QAAQ;QAEjC,sBAAsB;QACtB,MAAM,aAAa,QAAQ,WAAW,CAAC,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE5E,2BAA2B;QAC3B,MAAM,YAAY,QAAQ,SAAS,CAC9B,MAAM,CAAC,CAAC,IAAM,EAAE,cAAc,KAAK,SAAS,EAAE,EAC9C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,cAAc,QAAQ,SAAS,CAChC,MAAM,CAAC,CAAC,IAAM,EAAE,YAAY,KAAK,SAAS,EAAE,EAC5C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,cAAc;QACd,MAAM,YAAY,QAAQ,WAAW,CAChC,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,EAAE,IAAI,KAAK,cACzD,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,UAAU,QAAQ,WAAW,CAC9B,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,EAAE,IAAI,KAAK,WACzD,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,UAAU,QAAQ,WAAW,CAC9B,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,EAAE,IAAI,KAAK,WACzD,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,QAAQ;QACR,MAAM,WAAW,QAAQ,KAAK,CACzB,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,CAAC,EAAE,QAAQ,EACzD,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,UAAU,QAAQ,KAAK,CACxB,MAAM,CAAC,CAAC,IAAM,EAAE,UAAU,KAAK,SAAS,EAAE,IAAI,EAAE,QAAQ,EACxD,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,gBAAgB;QAChB,MAAM,eACF,eACA,aACA,cACA,YACA,UACA,YACA,WACA,UACA;QAEJ,OAAO;YACH,aAAa,QAAQ,IAAI;YACzB,UAAU,SAAS,IAAI;YACvB;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACJ;IACJ;IAEA,OAAO;AACX"}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/reports/page.tsx"],"sourcesContent":["// app/reports/page.tsx\r\nimport { getStockReport } from \"./stockReport\";\r\n\r\nexport default async function StockReportPage() {\r\n    const report = await getStockReport();\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <h1 className=\"text-2xl font-bold mb-4\">Stock Report</h1>\r\n            <div className=\"overflow-x-auto\">\r\n                <table className=\"table-auto border-collapse border border-gray-300 w-full\">\r\n                    <thead>\r\n                        <tr className=\"text-center\">\r\n                            <th className=\"border p-2\">Product</th>\r\n                            <th className=\"border p-2\">Location</th>\r\n                            <th className=\"border p-2\">Opening Stock</th>\r\n                            <th className=\"border p-2\">Production</th>\r\n                            <th className=\"border p-2\">IBT Rec</th>\r\n                            <th className=\"border p-2\">IBT Issued</th>\r\n                            <th className=\"border p-2\">Rebag Gain</th>\r\n                            <th className=\"border p-2\">Damaged</th>\r\n                            <th className=\"border p-2\">Expired</th>\r\n                            <th className=\"border p-2\">Returns</th>\r\n                            <th className=\"border p-2\">Sales Qty</th>\r\n                            <th className=\"border p-2\">Closing Stock</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {report.map((row, i) => (\r\n                            <tr key={i} className=\"text-center\">\r\n                                <td className=\"border p-2\">{row.productName}</td>\r\n                                <td className=\"border p-2\">{row.location}</td>\r\n                                <td className=\"border p-2\">{row.openingStock}</td>\r\n                                <td className=\"border p-2\">{row.production}</td>\r\n                                <td className=\"border p-2\">{row.ibtReceived}</td>\r\n                                <td className=\"border p-2\">{row.ibtIssued}</td>\r\n                                <td className=\"border p-2\">{row.rebagGain}</td>\r\n                                <td className=\"border p-2\">{row.damaged}</td>\r\n                                <td className=\"border p-2\">{row.expired}</td>\r\n                                <td className=\"border p-2\">{row.returns}</td>\r\n                                <td className=\"border p-2\">{row.salesQty}</td>\r\n                                <td className=\"border p-2\">{row.closingStock}</td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,uBAAuB;;;;;;AACvB;;;;;;;AAEe,eAAe;IAC1B,MAAM,SAAS,MAAM,IAAA,2LAAc;IAEnC,qBACI,mRAAC;QAAI,WAAU;;0BACX,mRAAC;gBAAG,WAAU;0BAA0B;;;;;;0BACxC,mRAAC;gBAAI,WAAU;0BACX,cAAA,mRAAC;oBAAM,WAAU;;sCACb,mRAAC;sCACG,cAAA,mRAAC;gCAAG,WAAU;;kDACV,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;kDAC3B,mRAAC;wCAAG,WAAU;kDAAa;;;;;;;;;;;;;;;;;sCAGnC,mRAAC;sCACI,OAAO,GAAG,CAAC,CAAC,KAAK,kBACd,mRAAC;oCAAW,WAAU;;sDAClB,mRAAC;4CAAG,WAAU;sDAAc,IAAI,WAAW;;;;;;sDAC3C,mRAAC;4CAAG,WAAU;sDAAc,IAAI,QAAQ;;;;;;sDACxC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,YAAY;;;;;;sDAC5C,mRAAC;4CAAG,WAAU;sDAAc,IAAI,UAAU;;;;;;sDAC1C,mRAAC;4CAAG,WAAU;sDAAc,IAAI,WAAW;;;;;;sDAC3C,mRAAC;4CAAG,WAAU;sDAAc,IAAI,SAAS;;;;;;sDACzC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,SAAS;;;;;;sDACzC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,OAAO;;;;;;sDACvC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,OAAO;;;;;;sDACvC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,OAAO;;;;;;sDACvC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,QAAQ;;;;;;sDACxC,mRAAC;4CAAG,WAAU;sDAAc,IAAI,YAAY;;;;;;;mCAZvC;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoBrC"}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../generated/prisma/client'\n\nconst connectionString = `${process.env.DATABASE_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,4MAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,yLAAY,CAAC;IAAE;AAAQ"}}]
}