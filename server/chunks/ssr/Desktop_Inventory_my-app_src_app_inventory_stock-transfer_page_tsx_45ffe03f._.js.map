{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/inventory/stock-transfer/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useStackApp } from \"@stackframe/stack\";\r\nimport Sidebar from \"@/components/sidebar2\";\r\nimport { useEffect, useState } from \"react\";\r\nimport toast from \"react-hot-toast\";\r\n\r\n// Define types for Product and Location\r\ninterface Product {\r\n    id: string;\r\n    name: string;\r\n}\r\n\r\ninterface Location {\r\n    id: string;\r\n    name: string;\r\n}\r\n\r\nexport default function StockTransferPage() {\r\n    const stackApp = useStackApp();\r\n    const user = stackApp.useUser();\r\n\r\n    const userId = user?.id;\r\n    // State for products and locations\r\n    const [products, setProducts] = useState<Product[]>([]);\r\n    const [locations, setLocations] = useState<Location[]>([]);\r\n\r\n    // Form state\r\n    const [productId, setProductId] = useState(\"\");\r\n    const [fromLocationId, setFromLocationId] = useState(\"\");\r\n    const [toLocationId, setToLocationId] = useState(\"\");\r\n    const [quantity, setQuantity] = useState(0);\r\n\r\n    // Step 2: Fetch products and locations once we have userId\r\n    useEffect(() => {\r\n        if (!userId) return;\r\n\r\n        const fetchData = async () => {\r\n            try {\r\n                const [productsRes, locationsRes] = await Promise.all([\r\n                    fetch(\"/api/products\"),\r\n                    fetch(`/api/locations?userId=${userId}`),\r\n                ]);\r\n\r\n                const productsData = await productsRes.json();\r\n                const locationsData = await locationsRes.json();\r\n\r\n                const productsArray: Product[] = Array.isArray(productsData)\r\n                    ? productsData\r\n                    : Array.isArray(productsData.products)\r\n                        ? productsData.products\r\n                        : [];\r\n\r\n                const locationsArray: Location[] = Array.isArray(locationsData.locations)\r\n                    ? locationsData.locations\r\n                    : [];\r\n\r\n                setProducts(productsArray);\r\n                setLocations(locationsArray);\r\n            } catch (err) {\r\n                console.error(err);\r\n                toast.error(\"Failed to load products or locations\");\r\n            }\r\n        };\r\n\r\n        fetchData();\r\n    }, [userId]);\r\n\r\n    // Step 3: Handle form submission\r\n    const submitTransfer = async () => {\r\n        if (!productId || !fromLocationId || !toLocationId || quantity <= 0) {\r\n            toast.error(\"Fill all fields correctly\");\r\n            return;\r\n        }\r\n\r\n        if (fromLocationId === toLocationId) {\r\n            toast.error(\"From and To locations cannot be the same\");\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const res = await fetch(\"/api/stock-transfer\", {\r\n                method: \"POST\",\r\n                headers: { \"Content-Type\": \"application/json\" },\r\n                body: JSON.stringify({\r\n                    productId,\r\n                    fromLocationId,\r\n                    toLocationId,\r\n                    quantity,\r\n                }),\r\n            });\r\n\r\n            const data = await res.json();\r\n\r\n            if (!res.ok) {\r\n                toast.error(data.error || \"Transfer failed\");\r\n                return;\r\n            }\r\n\r\n            toast.success(\"Stock transferred successfully\");\r\n            setQuantity(0);\r\n            setProductId(\"\");\r\n            setFromLocationId(\"\");\r\n            setToLocationId(\"\");\r\n        } catch (err) {\r\n            console.error(err);\r\n            toast.error(\"Something went wrong\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50\">\r\n            <main className=\"ml-64 p-8\">\r\n                <h1 className=\"text-xl font-semibold\">Stock Transfer</h1>\r\n\r\n                {/* Product */}\r\n                <select\r\n                    className=\"border p-2 w-full\"\r\n                    value={productId}\r\n                    onChange={(e) => setProductId(e.target.value)}\r\n                >\r\n                    <option value=\"\">Select Product</option>\r\n                    {products.map((p) => (\r\n                        <option key={p.id} value={p.id}>\r\n                            {p.name}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* From Location */}\r\n                <select\r\n                    className=\"border p-2 w-full\"\r\n                    value={fromLocationId}\r\n                    onChange={(e) => setFromLocationId(e.target.value)}\r\n                >\r\n                    <option value=\"\">From Location</option>\r\n                    {locations.map((l) => (\r\n                        <option key={l.id} value={l.id}>\r\n                            {l.name}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* To Location */}\r\n                <select\r\n                    className=\"border p-2 w-full\"\r\n                    value={toLocationId}\r\n                    onChange={(e) => setToLocationId(e.target.value)}\r\n                >\r\n                    <option value=\"\">To Location</option>\r\n                    {locations.map((l) => (\r\n                        <option key={l.id} value={l.id}>\r\n                            {l.name}\r\n                        </option>\r\n                    ))}\r\n                </select>\r\n\r\n                {/* Quantity */}\r\n                <input\r\n                    type=\"number\"\r\n                    className=\"border p-2 w-full\"\r\n                    placeholder=\"Quantity\"\r\n                    min={1}\r\n                    value={quantity}\r\n                    onChange={(e) => setQuantity(Number(e.target.value))}\r\n                />\r\n\r\n                {/* Submit */}\r\n                <button\r\n                    onClick={submitTransfer}\r\n                    className=\"bg-black text-white px-4 py-2 rounded w-full\"\r\n                >\r\n                    Transfer Stock\r\n                </button>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}