{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/dashboard/sales/page.tsx"],"sourcesContent":["import Sidebar from \"@/components/sidebar2\";\r\nimport { getCurrentUser } from \"@/lib/auth\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { DollarSign, TrendingUp, Users, ShoppingBag, Calendar, MapPin } from \"lucide-react\";\r\nimport SalesTrendChart from \"@/components/SalesTrendChart\";\r\nimport TopProducts from \"@/components/TopProducts\";\r\nimport LeastProducts from \"@/components/LeastProducts\";\r\nimport RecentSales from \"@/components/RecentSales\";\r\nimport TopCustomers from \"@/components/TopCustomers\";\r\nimport LeastCustomers from \"@/components/LeastCustomers\";\r\nimport SalesByLocation from \"@/components/SalesByLocation\";\r\nimport { DashboardSale } from \"@/components/DashboardSale\";\r\nimport SalesByCustomer from \"@/components/SalesByCustomer\";\r\nimport SalesByProduct from \"@/components/SalesByProduct\";\r\nimport SalesTable from \"@/components/SalesTable\";\r\nimport DateFiltersExports from \"@/components/DateFiltersExports\";\r\nimport DashboardLayout from \"@/components/DashboardLayout\";\r\n\r\ninterface ChartDataPoint {\r\n    date: string;\r\n    value: number;\r\n    quantity: number;\r\n    tonnage: number;\r\n}\r\n\r\ninterface Props {\r\n    currentPath?: string;\r\n}\r\n\r\ninterface CategoryTrendDataPoint {\r\n    date: string;\r\n    [category: string]: number | string;\r\n}\r\n\r\nexport default async function SalesDashboardPage() {\r\n    const user = await getCurrentUser();\r\n    if (!user) return <div>Please log in.</div>;\r\n    const userId = user.id;\r\n\r\n    // Metrics\r\n    const sales: DashboardSale[] = await prisma.sale.findMany({\r\n        where: { createdBy: userId },\r\n        include: {\r\n            product: {\r\n                select: {\r\n                    name: true,\r\n                    price: true,\r\n                    category: true,\r\n                    weightValue: true,\r\n                    packSize: true\r\n                },\r\n            },\r\n            location: { select: { name: true } }\r\n        },\r\n    });\r\n\r\n    // 1. Get product sales with quantities\r\n    const productSales = await prisma.sale.groupBy({\r\n        by: ['productId'],\r\n        where: {\r\n            createdBy: userId,\r\n            saleDate: {\r\n                gte: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000), // last 30 days\r\n            },\r\n        },\r\n        _sum: {\r\n            quantity: true,\r\n        },\r\n    });\r\n\r\n    // 2. Fetch product details for the IDs\r\n    const productIds = productSales.map((sale) => sale.productId);\r\n    const products = await prisma.productList.findMany({\r\n        where: { id: { in: productIds } },\r\n        select: { id: true, name: true, price: true },\r\n    });\r\n\r\n    // 3. Merge sales data with product info\r\n    const salesByProduct = productSales\r\n        .map((sale) => {\r\n            const product = products.find((p) => p.id === sale.productId);\r\n            if (!product) return null;\r\n            return {\r\n                id: product.id,\r\n                name: product.name,\r\n                totalValue: product.price * (sale._sum.quantity || 0),\r\n                qty: sale._sum.quantity || 0,\r\n            };\r\n        })\r\n        .filter(Boolean) // Remove nulls\r\n        .sort((a, b) => b.totalValue - a.totalValue);\r\n\r\n    const topSellingProducts = salesByProduct.slice(0, 5);\r\n    const leastSellingProducts = salesByProduct.slice(-5).reverse();\r\n\r\n    // Total Sales, Total Orders, Average Order Value\r\n    const totalSales = sales.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n    const totalOrders = sales.length;\r\n    const avgOrderValue = totalOrders > 0 ? totalSales / totalOrders : 0;\r\n\r\n    const customers = await prisma.customer.findMany({\r\n        where: { createdBy: userId },\r\n        include: {\r\n            sales: {\r\n                include: { product: true }\r\n            }\r\n        },\r\n    });\r\n\r\n\r\n    const totalCustomers = customers.length;\r\n\r\n    // 1. Total Revenue Growth (vs. Last Month)\r\n    const lastMonthStart = new Date(new Date().getFullYear(), new Date().getMonth() - 1, 1);\r\n    const lastMonthEnd = new Date(new Date().getFullYear(), new Date().getMonth(), 0);\r\n    const prevMonthSales = await prisma.sale.findMany({\r\n        where: {\r\n            createdBy: userId,\r\n            saleDate: { gte: lastMonthStart, lte: lastMonthEnd },\r\n        },\r\n    });\r\n    const prevMonthTotal = prevMonthSales.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n    const growth = prevMonthTotal ? ((totalSales - prevMonthTotal) / prevMonthTotal * 100).toFixed(1) : \"0\";\r\n\r\n    // 2. Conversion Rate\r\n    const conversionRate = totalCustomers > 0 ? (totalOrders / totalCustomers * 100).toFixed(1) : \"0\";\r\n\r\n    // 3. Sales per Product Category\r\n    const salesByCategory = sales.reduce((acc, sale) => {\r\n        const category = sale.product.category || 'Uncategorized';\r\n        if (!acc[category]) {\r\n            acc[category] = { totalValue: 0, qty: 0 };\r\n        }\r\n        acc[category].totalValue += sale.quantity * sale.salePrice;\r\n        acc[category].qty += sale.quantity;\r\n        return acc;\r\n    }, {} as Record<string, { totalValue: number; qty: number }>);\r\n\r\n    // 4. Average Items per Order\r\n    const totalItemsSold = sales.reduce((sum, sale) => sum + sale.quantity, 0);\r\n    const avgItemsPerOrder = totalOrders > 0 ? (totalItemsSold / totalOrders).toFixed(1) : \"0\";\r\n\r\n    // 5. Top Selling Location\r\n    const salesByLocation = sales.reduce((acc, sale) => {\r\n        const loc = sale.location?.name || 'Unknown';\r\n        acc[loc] = (acc[loc] || 0) + sale.quantity * sale.salePrice;\r\n        return acc;\r\n    }, {} as Record<string, number>);\r\n    const topLocation = Object.entries(salesByLocation).sort((a, b) => b[1] - a[1])[0]?.[0] || 'None';\r\n\r\n    // YTD and MTD Sales\r\n    const startOfYear = new Date(new Date().getFullYear(), 0, 1);\r\n    const startOfMonth = new Date(new Date().getFullYear(), new Date().getMonth(), 1);\r\n\r\n    const salesYTD = await prisma.sale.findMany({\r\n        where: { createdBy: userId, saleDate: { gte: startOfYear } },\r\n        include: { product: { select: { price: true } } },\r\n    });\r\n    const totalSalesYTD = salesYTD.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n\r\n    const salesMTD = await prisma.sale.findMany({\r\n        where: { createdBy: userId, saleDate: { gte: startOfMonth } },\r\n        include: { product: { select: { price: true } } },\r\n    });\r\n    const totalSalesMTD = salesMTD.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n\r\n    // Current year\r\n    const startOfCurrentYear = new Date(new Date().getFullYear(), 0, 1);\r\n    const endOfCurrentYear = new Date();\r\n\r\n    // Previous year\r\n    const startOfLastYear = new Date(new Date().getFullYear() - 1, 0, 1);\r\n    const endOfLastYear = new Date(new Date().getFullYear() - 1, 11, 31);\r\n\r\n    // Total sales this year\r\n    const salesThisYear = sales.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n\r\n    // Total sales last year\r\n    const lastYearSales = await prisma.sale.findMany({\r\n        where: {\r\n            createdBy: userId,\r\n            saleDate: { gte: startOfLastYear, lte: endOfLastYear },\r\n        },\r\n    });\r\n    const salesLastYear = lastYearSales.reduce((sum, sale) => sum + sale.quantity * sale.salePrice, 0);\r\n\r\n    // YoY growth %\r\n    const yoyGrowth = salesLastYear\r\n        ? ((salesThisYear - salesLastYear) / salesLastYear) * 100\r\n        : 0;\r\n\r\n    // Recent sales (last 7 days)\r\n    const thirtyDaysAgo = new Date();\r\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\r\n    const recentSales = sales\r\n        .filter(sale => sale.saleDate >= thirtyDaysAgo)\r\n        .sort((a, b) => b.saleDate.getTime() - a.saleDate.getTime())\r\n        .slice(0, 10);\r\n\r\n    // Top products (by quantity sold)\r\n    const topProducts = sales\r\n        .reduce((acc, sale) => {\r\n            const name = sale.product.name;\r\n            acc[name] = (acc[name] || 0) + sale.quantity;\r\n            return acc;\r\n        }, {} as Record<string, number>)\r\n    const topProductsArray = Object.entries(topProducts)\r\n        .sort((a, b) => b[1] - a[1])\r\n        .slice(0, 5)\r\n        .map(([name, qty]) => ({ name, qty }));\r\n\r\n    // Sales trend data (preparing data for charts)\r\n    const productList = await prisma.productList.findMany({\r\n        select: { id: true, weightValue: true, packSize: true },\r\n    });\r\n\r\n    if (productList.length === 0) {\r\n        console.warn(\"No products found for tonnage calculation.\");\r\n    }\r\n\r\n    const salesTrendData = sales\r\n        .reduce((acc, sale) => {\r\n            const date = new Date(sale.saleDate).toISOString().split('T')[0];\r\n            const product = productList.find(p => p.id === sale.productId);\r\n            const weightInTons = product ? (product.weightValue * sale.quantity * product.packSize) / 1000 : 0;\r\n\r\n            const existing = acc.find(d => d.date === date);\r\n            if (existing) {\r\n                existing.value += sale.salePrice * sale.quantity;\r\n                existing.quantity += sale.quantity;\r\n                existing.tonnage += weightInTons;\r\n            } else {\r\n                acc.push({\r\n                    date,\r\n                    value: sale.salePrice * sale.quantity,\r\n                    quantity: sale.quantity,\r\n                    tonnage: weightInTons,\r\n                });\r\n            }\r\n            return acc;\r\n        }, [] as ChartDataPoint[])\r\n        .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\r\n\r\n    // Sales Category trend data\r\n    const salesCategoryTrendData = (sales || []).reduce((acc, sale) => {\r\n        const date = new Date(sale.saleDate).toISOString().split('T')[0];\r\n        const category = sale.product?.category || 'Uncategorized'; // Optional chaining for safety\r\n        const existing = acc.find(d => d.date === date);\r\n\r\n        if (existing) {\r\n            existing[category] = (existing[category] || 0) + sale.quantity;\r\n        } else {\r\n            acc.push({\r\n                date,\r\n                [category]: sale.quantity,\r\n            });\r\n        }\r\n        return acc;\r\n    }, [] as CategoryTrendDataPoint[]).sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\r\n\r\n    // Top Customers and Least Customers\r\n    const topCustomers = [...customers]\r\n        .sort((a, b) => (b.sales?.length || 0) - (a.sales?.length || 0))\r\n        .slice(0, 5);\r\n\r\n    const leastCustomers = [...customers]\r\n        .sort((a, b) => (a.sales?.length || 0) - (b.sales?.length || 0))\r\n        .slice(0, 5);\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gray-50\">\r\n            <DashboardLayout>\r\n\r\n                {/* Header */}\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold\">Sales Dashboard</h1>\r\n                    <p className=\"text-gray-500 mt-1\">Track your sales performance and trends</p>\r\n                </div>\r\n                {/* KPIs */}\r\n                <div className=\"grid grid-cols-2 xl:grid-cols-8 gap-2\">\r\n                    <KPI title=\"Total Sales\" value={`K${totalSales.toFixed(0)}`} icon={<DollarSign />} color=\"blue\" />\r\n                    <KPI title=\"Sales YTD\" value={`K${totalSalesYTD.toFixed(0)}`} icon={<Calendar />} color=\"yellow\" />\r\n                    <KPI title=\"Sales MTD\" value={`K${totalSalesMTD.toFixed(0)}`} icon={<Calendar />} color=\"yellow\" />\r\n                    <KPI\r\n                        title=\"YoY Growth\"\r\n                        value={`${yoyGrowth >= 0 ? '+' : ''}${yoyGrowth.toFixed(1)}%`}\r\n                        icon={<TrendingUp />}\r\n                        color={yoyGrowth >= 0 ? \"green\" : \"red\"}\r\n                    />\r\n                    <KPI title=\"Monthly Growth\" value={`${growth}%`} icon={<TrendingUp />} color=\"blue\" />\r\n                    <KPI title=\"Customers\" value={totalCustomers} icon={<Users />} color=\"yellow\" />\r\n                    <KPI title=\"Orders\" value={totalOrders} icon={<ShoppingBag />} color=\"blue\" />\r\n                    <KPI title=\"Avg. Order Value\" value={`K${avgOrderValue.toFixed(0)}`} icon={<TrendingUp />} color=\"blue\" />\r\n                    {/*<KPI title=\"Items per Order\" value={avgItemsPerOrder} icon={<ShoppingBag />} color=\"green\" />*/}\r\n                    {/*<KPI title=\"Conversion Rate\" value={`${conversionRate}%`} icon={<Users />} color=\"purple\" />*/}\r\n                </div>\r\n\r\n                {/* Main Grid */}\r\n                <div>\r\n                    <SalesTrendChart\r\n                        salesTrendData={salesTrendData || []}\r\n                        sales={sales || []}\r\n                        productList={productList || []}\r\n                    />\r\n                </div>\r\n                <div className=\"grid grid-cols-1 xl:grid-cols-3 gap-6 mb-5\">\r\n                    <TopProducts\r\n                        products={topSellingProducts}\r\n                        title=\"Top Selling Products (Last 30 Days)\"\r\n                        iconColor=\"text-yellow-500\"\r\n                    />\r\n                    <LeastProducts products={leastSellingProducts} />\r\n\r\n                    {/* Sales by Category */}\r\n                    <div className=\"bg-white p-6 rounded-xl border hover:shadow-md transition-shadow\">\r\n                        <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n                            <Calendar className=\"h-5 w-5 text-blue-500\" /> Sales by Category\r\n                        </h3>\r\n                        {Object.entries(salesByCategory).length === 0 ? (\r\n                            <p className=\"text-sm text-gray-500\">No sales data.</p>\r\n                        ) : (\r\n                            <ul className=\"space-y-3 text-sm overflow-y-auto\">\r\n                                {Object.entries(salesByCategory).map(([category, data]) => (\r\n                                    <li key={category} className=\"flex justify-between items-center\">\r\n                                        <span className=\"font-medium\">{category}</span>\r\n                                        <span>{data.qty} units</span>\r\n                                        <span className=\"font-bold text-purple-600\">K{data.totalValue.toFixed(0)}</span>\r\n                                    </li>\r\n                                ))}\r\n                            </ul>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Top Customers and Location */}\r\n                <div className=\"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-5\">\r\n                    <TopCustomers\r\n                        customers={topCustomers}\r\n                        title=\"Top Customers (Last 30 Days)\"\r\n                        iconColor=\"text-green-500\"\r\n                    />\r\n                    <LeastCustomers customers={leastCustomers} />\r\n                </div>\r\n                {/* Sales by Location */}\r\n                <div className=\"grid grid-cols-1 xl:grid-cols-1 gap-6 mb-5\">\r\n                    <SalesTable sales={sales} />\r\n                </div>\r\n                <RecentSales sales={recentSales} />\r\n\r\n            </DashboardLayout >\r\n        </div >\r\n    );\r\n}\r\n\r\n/* -----------------------------\r\n   REUSABLE COMPONENTS\r\n----------------------------- */\r\nconst iconColors = {\r\n    purple: \"text-purple-600\",\r\n    green: \"text-green-600\",\r\n    yellow: \"text-yellow-500\",\r\n    red: \"text-red-600\",\r\n    blue: \"text-blue-600\",\r\n};\r\n\r\nconst bgColors = {\r\n    purple: \"bg-purple-500\",\r\n    green: \"bg-green-500\",\r\n    yellow: \"bg-yellow-400\",\r\n    red: \"bg-red-500\",\r\n    blue: \"bg-blue-500\",\r\n};\r\n\r\ntype Color = keyof typeof iconColors;\r\n\r\ninterface Props {\r\n    title: string;\r\n    value: string;\r\n    icon: React.ReactNode;\r\n    color: Color;\r\n}\r\n\r\nfunction KPI({ title, value, icon, color }: Props) {\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-xl border flex justify-between items-center\">\r\n            <div>\r\n                <p className=\"text-sm text-gray-500\">{title}</p>\r\n                <h2 className=\"text-2xl font-bold\">{value}</h2>\r\n            </div>\r\n\r\n            {/* Icon */}\r\n            <div\r\n                className={`${iconColors[color]}`}\r\n            >\r\n                {icon}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 701, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/stack/server.tsx"],"sourcesContent":["import \"server-only\";\n\nimport { StackServerApp } from \"@stackframe/stack\";\nimport { stackClientApp } from \"./client\";\n\nexport const stackServerApp = new StackServerApp({\n  inheritsFrom: stackClientApp,\n});\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;;;;AAEO,MAAM,iBAAiB,IAAI,oOAAc,CAAC;IAC/C,cAAc,yIAAc;AAC9B"}},
    {"offset": {"line": 718, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/auth.ts"],"sourcesContent":["import { stackServerApp } from \"@/stack/server\";\nimport { redirect } from \"next/navigation\";\n\n\nexport async function getCurrentUser() {\n    const user = await stackServerApp.getUser()\n    if (!user) {\n        redirect(\"/sign-in\");\n    }\n\n    return user;\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAGO,eAAe;IAClB,MAAM,OAAO,MAAM,yIAAc,CAAC,OAAO;IACzC,IAAI,CAAC,MAAM;QACP,IAAA,iMAAQ,EAAC;IACb;IAEA,OAAO;AACX"}},
    {"offset": {"line": 740, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../generated/prisma/client'\n\nconst connectionString = `${process.env.DATABASE_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,uKAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,oJAAY,CAAC;IAAE;AAAQ"}},
    {"offset": {"line": 767, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/SalesTrendChart.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/SalesTrendChart.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/SalesTrendChart.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsS,GACnU,oEACA","ignoreList":[0]}},
    {"offset": {"line": 781, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/SalesTrendChart.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/SalesTrendChart.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/SalesTrendChart.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkR,GAC/S,gDACA","ignoreList":[0]}},
    {"offset": {"line": 795, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 803, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/TopProducts.tsx"],"sourcesContent":["import { Star } from \"lucide-react\";\r\nimport { Product } from \"./Product\";\r\n\r\ninterface Props {\r\n    products: Product[];\r\n    title: string;\r\n    iconColor: string;\r\n    limit?: number;\r\n}\r\n\r\nexport default function TopProducts({ products, title, iconColor, limit = 5 }: Props) {\r\n    const displayedProducts = products.slice(0, limit);\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-xl border hover:shadow-md transition-shadow\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n                <Star className={`h-5 w-5 ${iconColor}`} />\r\n                {title}\r\n            </h3>\r\n            {displayedProducts.length === 0 ? (\r\n                <p className=\"text-sm text-gray-500\">No products sold yet.</p>\r\n            ) : (\r\n                <ul className=\"space-y-3 text-sm\">\r\n                    {displayedProducts.map((product, index) => (\r\n                        <li key={product.id} className=\"flex justify-between items-center\">\r\n                            <span className=\"truncate font-medium\">\r\n                                {index + 1}. {product.name}\r\n                            </span>\r\n                            <span className=\"text-gray-600\">{product.qty} units</span>\r\n                            <span className=\"font-bold text-purple-600\">\r\n                                K{product.totalValue.toFixed(2)}\r\n                            </span>\r\n                        </li>\r\n                    ))}\r\n                </ul>\r\n            )}\r\n            {products.length > limit && (\r\n                <p className=\"text-sm text-gray-500 mt-2\">\r\n                    Showing top {limit} products. <a href=\"#\" className=\"text-blue-500\">View all</a>\r\n                </p>\r\n            )}\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":";;;;;AAAA;;;AAUe,SAAS,YAAY,EAAE,QAAQ,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,EAAS;IAChF,MAAM,oBAAoB,SAAS,KAAK,CAAC,GAAG;IAE5C,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAG,WAAU;;kCACV,8OAAC,0MAAI;wBAAC,WAAW,CAAC,QAAQ,EAAE,WAAW;;;;;;oBACtC;;;;;;;YAEJ,kBAAkB,MAAM,KAAK,kBAC1B,8OAAC;gBAAE,WAAU;0BAAwB;;;;;qCAErC,8OAAC;gBAAG,WAAU;0BACT,kBAAkB,GAAG,CAAC,CAAC,SAAS,sBAC7B,8OAAC;wBAAoB,WAAU;;0CAC3B,8OAAC;gCAAK,WAAU;;oCACX,QAAQ;oCAAE;oCAAG,QAAQ,IAAI;;;;;;;0CAE9B,8OAAC;gCAAK,WAAU;;oCAAiB,QAAQ,GAAG;oCAAC;;;;;;;0CAC7C,8OAAC;gCAAK,WAAU;;oCAA4B;oCACtC,QAAQ,UAAU,CAAC,OAAO,CAAC;;;;;;;;uBAN5B,QAAQ,EAAE;;;;;;;;;;YAY9B,SAAS,MAAM,GAAG,uBACf,8OAAC;gBAAE,WAAU;;oBAA6B;oBACzB;oBAAM;kCAAW,8OAAC;wBAAE,MAAK;wBAAI,WAAU;kCAAgB;;;;;;;;;;;;;;;;;;AAKxF"}},
    {"offset": {"line": 922, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/LeastProducts.tsx"],"sourcesContent":["import { AlertTriangle } from \"lucide-react\";\r\nimport TopProducts from \"./TopProducts\";\r\nimport { Product } from \"./Product\";\r\n\r\ninterface Props {\r\n    products: Product[];\r\n}\r\n\r\nexport default function LeastProducts({ products }: Props) {\r\n    const sortedProducts = products.sort((a, b) => a.qty - b.qty);\r\n\r\n    return (\r\n        <TopProducts\r\n            products={sortedProducts}\r\n            title=\"Least Selling Products (Last 30 Days)\"\r\n            iconColor=\"text-red-500\"\r\n        />\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;AAOe,SAAS,cAAc,EAAE,QAAQ,EAAS;IACrD,MAAM,iBAAiB,SAAS,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,GAAG,GAAG,EAAE,GAAG;IAE5D,qBACI,8OAAC,4IAAW;QACR,UAAU;QACV,OAAM;QACN,WAAU;;;;;;AAGtB"}},
    {"offset": {"line": 948, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/RecentSales.tsx"],"sourcesContent":["import { Clock } from \"lucide-react\";\r\nimport { prisma } from \"@/lib/prisma\";\r\nimport { Sale } from \"./Sale\";\r\n\r\ninterface Props {\r\n    userId: string;\r\n}\r\n\r\nexport default async function RecentSales({ userId }: Props) {\r\n    const sales: Sale[] = await prisma.sale.findMany({\r\n        where: { createdBy: userId },\r\n        orderBy: { createdAt: \"desc\" },\r\n        include: {\r\n            product: true,\r\n            location: true,\r\n        },\r\n    });\r\n\r\n    const recentSales = sales.slice(0, 10);\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-xl border hover:shadow-md transition-shadow mb-5\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n                <Clock className=\"h-5 w-5 text-blue-500\" /> Recent Sales\r\n            </h3>\r\n            {recentSales.length === 0 ? (\r\n                <p className=\"text-sm text-gray-500\">No recent sales.</p>\r\n            ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                    <table className=\"min-w-full text-sm\">\r\n                        <thead className=\"bg-gray-200 border-b\">\r\n                            <tr>\r\n                                <th className=\"px-4 py-2 border-r text-left\">Customer</th>\r\n                                <th className=\"px-4 py-2 border-r text-left\">Product</th>\r\n                                <th className=\"px-4 py-2 border-r text-left\">Location</th>\r\n                                <th className=\"px-4 py-2 border-r text-center\">Quantity</th>\r\n                                <th className=\"px-4 py-2 border-r text-center\">Price</th>\r\n                                <th className=\"px-4 py-2 border-r text-center\">Revenue</th>\r\n                                <th className=\"px-4 py-2 border-r text-center\">Date</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {recentSales.map((sale) => (\r\n                                <tr key={sale.id} className=\"border-b last:border-0 hover:bg-gray-50\">\r\n                                    <td className=\"px-4 py-3 truncate\">{sale.customerName || \"N/A\"}</td>\r\n                                    <td className=\"px-4 py-3 truncate\">{sale.product?.name || \"N/A\"}</td>\r\n                                    <td className=\"px-4 py-3 truncate\">{sale.location?.name || \"N/A\"}</td>\r\n                                    <td className=\"px-4 py-3 text-center\">{sale.quantity}</td>\r\n                                    <td className=\"px-4 py-3 text-center\">K{sale.salePrice.toFixed(2)}</td>\r\n                                    <td className=\"px-4 py-3 text-center\">K{(sale.salePrice * sale.quantity).toFixed(2)}</td>\r\n                                    <td className=\"px-4 py-3 text-center\">{new Date(sale.saleDate).toLocaleDateString()}</td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;;;;;;;;AAOe,eAAe,YAAY,EAAE,MAAM,EAAS;IACvD,MAAM,QAAgB,MAAM,8HAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QAC7C,OAAO;YAAE,WAAW;QAAO;QAC3B,SAAS;YAAE,WAAW;QAAO;QAC7B,SAAS;YACL,SAAS;YACT,UAAU;QACd;IACJ;IAEA,MAAM,cAAc,MAAM,KAAK,CAAC,GAAG;IAEnC,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAG,WAAU;;kCACV,8OAAC,6MAAK;wBAAC,WAAU;;;;;;oBAA0B;;;;;;;YAE9C,YAAY,MAAM,KAAK,kBACpB,8OAAC;gBAAE,WAAU;0BAAwB;;;;;qCAErC,8OAAC;gBAAI,WAAU;0BACX,cAAA,8OAAC;oBAAM,WAAU;;sCACb,8OAAC;4BAAM,WAAU;sCACb,cAAA,8OAAC;;kDACG,8OAAC;wCAAG,WAAU;kDAA+B;;;;;;kDAC7C,8OAAC;wCAAG,WAAU;kDAA+B;;;;;;kDAC7C,8OAAC;wCAAG,WAAU;kDAA+B;;;;;;kDAC7C,8OAAC;wCAAG,WAAU;kDAAiC;;;;;;kDAC/C,8OAAC;wCAAG,WAAU;kDAAiC;;;;;;kDAC/C,8OAAC;wCAAG,WAAU;kDAAiC;;;;;;kDAC/C,8OAAC;wCAAG,WAAU;kDAAiC;;;;;;;;;;;;;;;;;sCAGvD,8OAAC;sCACI,YAAY,GAAG,CAAC,CAAC,qBACd,8OAAC;oCAAiB,WAAU;;sDACxB,8OAAC;4CAAG,WAAU;sDAAsB,KAAK,YAAY,IAAI;;;;;;sDACzD,8OAAC;4CAAG,WAAU;sDAAsB,KAAK,OAAO,EAAE,QAAQ;;;;;;sDAC1D,8OAAC;4CAAG,WAAU;sDAAsB,KAAK,QAAQ,EAAE,QAAQ;;;;;;sDAC3D,8OAAC;4CAAG,WAAU;sDAAyB,KAAK,QAAQ;;;;;;sDACpD,8OAAC;4CAAG,WAAU;;gDAAwB;gDAAE,KAAK,SAAS,CAAC,OAAO,CAAC;;;;;;;sDAC/D,8OAAC;4CAAG,WAAU;;gDAAwB;gDAAE,CAAC,KAAK,SAAS,GAAG,KAAK,QAAQ,EAAE,OAAO,CAAC;;;;;;;sDACjF,8OAAC;4CAAG,WAAU;sDAAyB,IAAI,KAAK,KAAK,QAAQ,EAAE,kBAAkB;;;;;;;mCAP5E,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgBhD"}},
    {"offset": {"line": 1179, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/TopCustomers.tsx"],"sourcesContent":["import { Star } from \"lucide-react\";\r\nimport { Customer } from \"./Customer\";\r\n\r\ninterface Props {\r\n    customers: Customer[];\r\n    title: string;\r\n    iconColor: string;\r\n    limit?: number;\r\n}\r\n\r\nexport default function TopCustomers({ customers, title, iconColor, limit = 5 }: Props) {\r\n    const thirtyDaysAgo = new Date();\r\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\r\n\r\n    // Calculate total tonnage for each customer in the last 30 days\r\n    const customersWithTonnage = (customers || []).map(customer => {\r\n        const recentSales = customer.sales?.filter(sale => new Date(sale.saleDate) >= thirtyDaysAgo) || [];\r\n\r\n        const totalTonnage = recentSales.reduce((sum, sale) => {\r\n            const productWeight = sale.product?.weightValue || 0;\r\n            const packSize = sale.product?.packSize || 1;\r\n            return sum + (productWeight * sale.quantity * packSize) / 1000; // convert to tons\r\n        }, 0);\r\n\r\n        const totalSalesValue = recentSales.reduce((sum, sale) => {\r\n            return sum + (sale.totalAmount || sale.salePrice * sale.quantity);\r\n        }, 0);\r\n\r\n        return { ...customer, totalTonnage, totalSalesValue, recentSales };\r\n    });\r\n\r\n    // Sort by totalTonnage descending\r\n    const sortedCustomers = customersWithTonnage.sort((a, b) => b.totalTonnage - a.totalTonnage);\r\n    const displayedCustomers = sortedCustomers.slice(0, limit);\r\n\r\n    return (\r\n        <div className=\"bg-white p-6 rounded-xl border hover:shadow-md transition-shadow\">\r\n            <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\r\n                <Star className={`h-5 w-5 ${iconColor}`} />\r\n                {title}\r\n            </h3>\r\n\r\n            {displayedCustomers.length === 0 ? (\r\n                <p className=\"text-sm text-gray-500\">No customers yet.</p>\r\n            ) : (\r\n                <ul className=\"space-y-3 text-sm\">\r\n                    {displayedCustomers.map((customer, index) => {\r\n                        const totalTonnage = customer.totalTonnage;\r\n                        const totalSalesValue = customer.totalSalesValue;\r\n                        const purchaseCount = customer.recentSales.length;\r\n\r\n                        return (\r\n                            <li key={customer.id} className=\"flex flex-col-2 xl:flex-row justify-between items-start xl:items-center gap-1 xl:gap-0\">\r\n                                <span className=\"truncate font-medium\">\r\n                                    {index + 1}. {customer.name}\r\n                                </span>\r\n                                <span className=\"font-bold text-purple-600\">\r\n                                    {purchaseCount} purchases\r\n                                </span>\r\n                                <span className=\"font-bold text-green-600\">\r\n                                    {totalTonnage.toFixed(2)} tons\r\n                                </span>\r\n                                <span className=\"font-bold text-blue-600\">\r\n                                    K{totalSalesValue.toFixed(0)}\r\n                                </span>\r\n                            </li>\r\n                        );\r\n                    })}\r\n                </ul>\r\n            )}\r\n\r\n            {customers?.length > limit && (\r\n                <p className=\"text-sm text-gray-500 mt-2\">\r\n                    Showing top {limit} customers. <a href=\"#\" className=\"text-blue-500\">View all</a>\r\n                </p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;;AAUe,SAAS,aAAa,EAAE,SAAS,EAAE,KAAK,EAAE,SAAS,EAAE,QAAQ,CAAC,EAAS;IAClF,MAAM,gBAAgB,IAAI;IAC1B,cAAc,OAAO,CAAC,cAAc,OAAO,KAAK;IAEhD,gEAAgE;IAChE,MAAM,uBAAuB,CAAC,aAAa,EAAE,EAAE,GAAG,CAAC,CAAA;QAC/C,MAAM,cAAc,SAAS,KAAK,EAAE,OAAO,CAAA,OAAQ,IAAI,KAAK,KAAK,QAAQ,KAAK,kBAAkB,EAAE;QAElG,MAAM,eAAe,YAAY,MAAM,CAAC,CAAC,KAAK;YAC1C,MAAM,gBAAgB,KAAK,OAAO,EAAE,eAAe;YACnD,MAAM,WAAW,KAAK,OAAO,EAAE,YAAY;YAC3C,OAAO,MAAM,AAAC,gBAAgB,KAAK,QAAQ,GAAG,WAAY,MAAM,kBAAkB;QACtF,GAAG;QAEH,MAAM,kBAAkB,YAAY,MAAM,CAAC,CAAC,KAAK;YAC7C,OAAO,MAAM,CAAC,KAAK,WAAW,IAAI,KAAK,SAAS,GAAG,KAAK,QAAQ;QACpE,GAAG;QAEH,OAAO;YAAE,GAAG,QAAQ;YAAE;YAAc;YAAiB;QAAY;IACrE;IAEA,kCAAkC;IAClC,MAAM,kBAAkB,qBAAqB,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,YAAY,GAAG,EAAE,YAAY;IAC3F,MAAM,qBAAqB,gBAAgB,KAAK,CAAC,GAAG;IAEpD,qBACI,8OAAC;QAAI,WAAU;;0BACX,8OAAC;gBAAG,WAAU;;kCACV,8OAAC,0MAAI;wBAAC,WAAW,CAAC,QAAQ,EAAE,WAAW;;;;;;oBACtC;;;;;;;YAGJ,mBAAmB,MAAM,KAAK,kBAC3B,8OAAC;gBAAE,WAAU;0BAAwB;;;;;qCAErC,8OAAC;gBAAG,WAAU;0BACT,mBAAmB,GAAG,CAAC,CAAC,UAAU;oBAC/B,MAAM,eAAe,SAAS,YAAY;oBAC1C,MAAM,kBAAkB,SAAS,eAAe;oBAChD,MAAM,gBAAgB,SAAS,WAAW,CAAC,MAAM;oBAEjD,qBACI,8OAAC;wBAAqB,WAAU;;0CAC5B,8OAAC;gCAAK,WAAU;;oCACX,QAAQ;oCAAE;oCAAG,SAAS,IAAI;;;;;;;0CAE/B,8OAAC;gCAAK,WAAU;;oCACX;oCAAc;;;;;;;0CAEnB,8OAAC;gCAAK,WAAU;;oCACX,aAAa,OAAO,CAAC;oCAAG;;;;;;;0CAE7B,8OAAC;gCAAK,WAAU;;oCAA0B;oCACpC,gBAAgB,OAAO,CAAC;;;;;;;;uBAXzB,SAAS,EAAE;;;;;gBAe5B;;;;;;YAIP,WAAW,SAAS,uBACjB,8OAAC;gBAAE,WAAU;;oBAA6B;oBACzB;oBAAM;kCAAY,8OAAC;wBAAE,MAAK;wBAAI,WAAU;kCAAgB;;;;;;;;;;;;;;;;;;AAKzF"}},
    {"offset": {"line": 1336, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/LeastCustomers.tsx"],"sourcesContent":["import { AlertTriangle } from \"lucide-react\";\r\nimport TopCustomers from \"./TopCustomers\";\r\nimport { Customer } from \"./Customer\";\r\n\r\ninterface Props {\r\n    customers: Customer[];\r\n}\r\n\r\nexport default function LeastCustomers({ customers }: Props) {\r\n    const thirtyDaysAgo = new Date();\r\n    thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\r\n\r\n    const customersWithTonnage = (customers || []).map(customer => {\r\n        const recentSales = customer.sales?.filter(sale => new Date(sale.saleDate) >= thirtyDaysAgo) || [];\r\n        const totalTonnage = recentSales.reduce((sum, sale) => {\r\n            const productWeight = sale.product?.weightValue || 0;\r\n            const packSize = sale.product?.packSize || 1;\r\n            return sum + (productWeight * sale.quantity * packSize) / 1000; // convert to tons\r\n        }, 0);\r\n        return { ...customer, totalTonnage };\r\n    });\r\n\r\n    const sortedCustomers = customersWithTonnage.sort((a, b) => a.totalTonnage - b.totalTonnage);\r\n\r\n    return (\r\n        <TopCustomers\r\n            customers={sortedCustomers}\r\n            title=\"Least Active Customers (Last 30 Days)\"\r\n            iconColor=\"text-red-500\"\r\n        />\r\n    );\r\n}"],"names":[],"mappings":";;;;;AACA;;;AAOe,SAAS,eAAe,EAAE,SAAS,EAAS;IACvD,MAAM,gBAAgB,IAAI;IAC1B,cAAc,OAAO,CAAC,cAAc,OAAO,KAAK;IAEhD,MAAM,uBAAuB,CAAC,aAAa,EAAE,EAAE,GAAG,CAAC,CAAA;QAC/C,MAAM,cAAc,SAAS,KAAK,EAAE,OAAO,CAAA,OAAQ,IAAI,KAAK,KAAK,QAAQ,KAAK,kBAAkB,EAAE;QAClG,MAAM,eAAe,YAAY,MAAM,CAAC,CAAC,KAAK;YAC1C,MAAM,gBAAgB,KAAK,OAAO,EAAE,eAAe;YACnD,MAAM,WAAW,KAAK,OAAO,EAAE,YAAY;YAC3C,OAAO,MAAM,AAAC,gBAAgB,KAAK,QAAQ,GAAG,WAAY,MAAM,kBAAkB;QACtF,GAAG;QACH,OAAO;YAAE,GAAG,QAAQ;YAAE;QAAa;IACvC;IAEA,MAAM,kBAAkB,qBAAqB,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,YAAY,GAAG,EAAE,YAAY;IAE3F,qBACI,8OAAC,6IAAY;QACT,WAAW;QACX,OAAM;QACN,WAAU;;;;;;AAGtB"}},
    {"offset": {"line": 1374, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/SalesTable.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/SalesTable.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/SalesTable.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiS,GAC9T,+DACA","ignoreList":[0]}},
    {"offset": {"line": 1388, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/SalesTable.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/SalesTable.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/SalesTable.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA6Q,GAC1S,2CACA","ignoreList":[0]}},
    {"offset": {"line": 1402, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 1410, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/DashboardLayout.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/DashboardLayout.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/DashboardLayout.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAsS,GACnU,oEACA","ignoreList":[0]}},
    {"offset": {"line": 1424, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/DashboardLayout.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/DashboardLayout.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/DashboardLayout.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAkR,GAC/S,gDACA","ignoreList":[0]}},
    {"offset": {"line": 1438, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}}]
}