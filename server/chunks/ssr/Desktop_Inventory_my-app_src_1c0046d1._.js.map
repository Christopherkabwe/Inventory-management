{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/inventory/receipt/page.tsx"],"sourcesContent":["// src/app/inventory/receipt/page.tsx (Server Component)\r\nimport { logStockMovement } from '@/lib/stockMovement';\r\n\r\nexport default async function ReceiveStock() {\r\n    const movement = await logStockMovement({\r\n        inventoryId: 'inv123',\r\n        type: 'RECEIPT',\r\n        quantity: 50,\r\n        createdBy: 'user123',\r\n        reason: 'New shipment',\r\n    });\r\n\r\n    return <div>Received {movement.quantity} items.</div>;\r\n}\r\n"],"names":[],"mappings":"AAAA,wDAAwD;;;;;;AACxD;;;AAEe,eAAe;IAC1B,MAAM,WAAW,MAAM,IAAA,oLAAgB,EAAC;QACpC,aAAa;QACb,MAAM;QACN,UAAU;QACV,WAAW;QACX,QAAQ;IACZ;IAEA,qBAAO,mRAAC;;YAAI;YAAU,SAAS,QAAQ;YAAC;;;;;;;AAC5C"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/stockMovement.ts"],"sourcesContent":["import { PrismaClient, StockMovementType } from '../generated/prisma';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\ntype MovementType =\r\n    | 'RECEIPT'\r\n    | 'SALE'\r\n    | 'TRANSFER_IN'\r\n    | 'TRANSFER_OUT'\r\n    | 'RETURN'\r\n    | 'DAMAGED'\r\n    | 'REBAG_GAIN'\r\n    | 'REBAG_LOSS'\r\n    | 'EXPIRED'\r\n    | 'ADJUSTMENT';\r\n\r\ninterface StockMovementInput {\r\n    inventoryId: string;\r\n    type: MovementType;\r\n    quantity: number;\r\n    createdBy: string;\r\n    saleId?: string;\r\n    customerId?: string;\r\n    fromLocationId?: string;\r\n    toLocationId?: string;\r\n    reason?: string;\r\n    physicalStock?: number; // optional, for stocktake\r\n}\r\n\r\nexport async function logStockMovement(input: StockMovementInput) {\r\n    const inventory = await prisma.inventory.findUnique({\r\n        where: { id: input.inventoryId },\r\n    });\r\n\r\n    if (!inventory) throw new Error('Inventory not found');\r\n\r\n    let newQuantity = inventory.quantity;\r\n\r\n    // Adjust quantity based on movement type\r\n    switch (input.type) {\r\n        case 'RECEIPT':\r\n        case 'TRANSFER_IN':\r\n        case 'RETURN':\r\n        case 'REBAG_GAIN':\r\n            newQuantity += input.quantity;\r\n            break;\r\n\r\n        case 'SALE':\r\n        case 'TRANSFER_OUT':\r\n        case 'DAMAGED':\r\n        case 'REBAG_LOSS':\r\n        case 'EXPIRED':\r\n        case 'ADJUSTMENT':\r\n            newQuantity -= input.quantity;\r\n            break;\r\n\r\n        default:\r\n            throw new Error('Invalid movement type');\r\n    }\r\n\r\n    // Create StockMovement record\r\n    const movement = await prisma.stockMovement.create({\r\n        data: {\r\n            inventoryId: input.inventoryId,\r\n            type: input.type,\r\n            quantity: input.quantity,\r\n            openingStock: inventory.quantity,\r\n            closingStock: newQuantity,\r\n            physicalStock: input.physicalStock ?? null,\r\n            createdBy: input.createdBy,\r\n            saleId: input.saleId,\r\n            customerId: input.customerId,\r\n            fromLocationId: input.fromLocationId,\r\n            toLocationId: input.toLocationId,\r\n            reason: input.reason,\r\n        },\r\n    });\r\n\r\n    // Update Inventory quantity\r\n    await prisma.inventory.update({\r\n        where: { id: inventory.id },\r\n        data: { quantity: newQuantity },\r\n    });\r\n\r\n    return movement;\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,SAAS,IAAI,wLAAY;AA2BxB,eAAe,iBAAiB,KAAyB;IAC5D,MAAM,YAAY,MAAM,OAAO,SAAS,CAAC,UAAU,CAAC;QAChD,OAAO;YAAE,IAAI,MAAM,WAAW;QAAC;IACnC;IAEA,IAAI,CAAC,WAAW,MAAM,IAAI,MAAM;IAEhC,IAAI,cAAc,UAAU,QAAQ;IAEpC,yCAAyC;IACzC,OAAQ,MAAM,IAAI;QACd,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACD,eAAe,MAAM,QAAQ;YAC7B;QAEJ,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACD,eAAe,MAAM,QAAQ;YAC7B;QAEJ;YACI,MAAM,IAAI,MAAM;IACxB;IAEA,8BAA8B;IAC9B,MAAM,WAAW,MAAM,OAAO,aAAa,CAAC,MAAM,CAAC;QAC/C,MAAM;YACF,aAAa,MAAM,WAAW;YAC9B,MAAM,MAAM,IAAI;YAChB,UAAU,MAAM,QAAQ;YACxB,cAAc,UAAU,QAAQ;YAChC,cAAc;YACd,eAAe,MAAM,aAAa,IAAI;YACtC,WAAW,MAAM,SAAS;YAC1B,QAAQ,MAAM,MAAM;YACpB,YAAY,MAAM,UAAU;YAC5B,gBAAgB,MAAM,cAAc;YACpC,cAAc,MAAM,YAAY;YAChC,QAAQ,MAAM,MAAM;QACxB;IACJ;IAEA,4BAA4B;IAC5B,MAAM,OAAO,SAAS,CAAC,MAAM,CAAC;QAC1B,OAAO;YAAE,IAAI,UAAU,EAAE;QAAC;QAC1B,MAAM;YAAE,UAAU;QAAY;IAClC;IAEA,OAAO;AACX"}}]
}