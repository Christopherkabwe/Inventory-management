{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/dashboard/page.tsx"],"sourcesContent":["import Sidebar from \"@/components/sidebar\";\nimport { getCurrentUser } from \"@/lib/auth\";\nimport { prisma } from \"@/lib/prisma\";\nimport {\n    Package,\n    DollarSign,\n    AlertTriangle,\n    XCircle,\n    Bell,\n} from \"lucide-react\";\nimport StockHealthPie from \"@/components/stock-health-pie\";\n\nexport default async function DashboardPage() {\n    const user = await getCurrentUser();\n    if (!user) return <div>Please log in.</div>;\n    const userId = user.id;\n\n    /* -----------------------------\n       INVENTORY\n    ----------------------------- */\n    const allProducts = await prisma.inventory.findMany({\n        where: { createdBy: userId },\n        include: {\n            product: { select: { name: true, price: true } },\n        },\n    });\n\n    /* -----------------------------\n       SALES DATA (for burn rate)\n    ----------------------------- */\n    const sales = await prisma.sale.findMany({\n        where: { createdBy: userId },\n        orderBy: { saleDate: \"desc\" },\n        take: 50, // consider recent sales\n    });\n\n    /* -----------------------------\n       LOW-STOCK LOGIC\n    ----------------------------- */\n    const weakestTenIds = allProducts\n        .slice()\n        .sort((a, b) => a.quantity - b.quantity)\n        .slice(0, 10)\n        .map(i => i.id);\n\n    const isLowStock = (item: any) =>\n        item.quantity <= item.lowStockAt || weakestTenIds.includes(item.id);\n\n    /* -----------------------------\n       METRICS\n    ----------------------------- */\n    const totalProducts = allProducts.length;\n    const totalValue = allProducts.reduce(\n        (sum, i) => sum + i.quantity * i.product.price,\n        0\n    );\n    const inStock = allProducts.filter(i => i.quantity > 0 && !isLowStock(i)).length;\n    const lowStock = allProducts.filter(i => i.quantity > 0 && isLowStock(i)).length;\n    const outOfStock = allProducts.filter(i => i.quantity === 0).length;\n\n    /* -----------------------------\n       TOP LOW STOCK\n    ----------------------------- */\n    const topLowStock = allProducts\n        .filter(isLowStock)\n        .sort((a, b) => a.quantity - b.quantity)\n        .slice(0, 10);\n\n    /* -----------------------------\n       AUTO-RESTOCK ALERTS\n    ----------------------------- */\n    const restockAlerts = topLowStock.slice(0, 5);\n\n    /* -----------------------------\n       RECENT PRODUCTS\n    ----------------------------- */\n    const recentProducts = await prisma.inventory.findMany({\n        where: { createdBy: userId },\n        include: { product: true },\n        orderBy: { createdAt: \"desc\" },\n        take: 5,\n    });\n\n    /* -----------------------------\n       BURN-RATE PREDICTION\n       â†’ Days until stockout\n    ----------------------------- */\n    const burnRate = allProducts.map(item => {\n        // filter sales for this product\n        const productSales = sales.filter(s => s.productId === item.productId);\n        // calculate average daily sales (last 30 days)\n        const recentSales = productSales.filter(s => {\n            const saleDate = new Date(s.saleDate);\n            const daysAgo = (new Date().getTime() - saleDate.getTime()) / (1000 * 60 * 60 * 24);\n            return daysAgo <= 30;\n        });\n\n        const totalSold = recentSales.reduce((sum, s) => sum + s.quantity, 0);\n        const avgDaily = totalSold / (recentSales.length || 1);\n\n        const daysLeft = avgDaily > 0 ? Math.round(item.quantity / avgDaily) : null;\n\n        return {\n            product: item.product.name,\n            quantity: item.quantity,\n            daysLeft,\n        };\n    });\n\n    return (\n        <div className=\"min-h-screen bg-gray-50\">\n            <Sidebar currentPath=\"/dashboard\" />\n            <main className=\"ml-64 p-8 space-y-10\">\n\n                {/* HEADER */}\n                <div>\n                    <h1 className=\"text-3xl font-bold\">Dashboard</h1>\n                    <p className=\"text-gray-500 mt-1\">\n                        Inventory intelligence & risk monitoring\n                    </p>\n                </div>\n\n                {/* KPIs */}\n                <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n                    <KPI title=\"Products\" value={totalProducts} icon={<Package />} color=\"purple\" />\n                    <KPI title=\"Inventory Value\" value={`K${totalValue.toFixed(0)}`} icon={<DollarSign />} color=\"green\" />\n                    <KPI title=\"Low Stock\" value={lowStock} icon={<AlertTriangle />} color=\"yellow\" />\n                    <KPI title=\"Out of Stock\" value={outOfStock} icon={<XCircle />} color=\"red\" />\n                </div>\n\n                {/* MAIN GRID */}\n                <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n\n                    {/* STOCK HEALTH */}\n                    <div className=\"bg-white p-6 rounded-xl border\">\n                        <h3 className=\"font-semibold mb-4\">Stock Health</h3>\n                        <StockHealthPie\n                            inStock={inStock}\n                            lowStock={lowStock}\n                            outOfStock={outOfStock}\n                        />\n                    </div>\n\n                    {/* AUTO-RESTOCK ALERTS */}\n                    <div className=\"bg-white p-6 rounded-xl border\">\n                        <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\n                            <Bell className=\"h-5 w-5 text-red-500\" />\n                            Auto-Restock Alerts\n                        </h3>\n\n                        {restockAlerts.length === 0 ? (\n                            <p className=\"text-sm text-gray-500\">No alerts ðŸŽ‰</p>\n                        ) : (\n                            <ul className=\"space-y-3 text-sm\">\n                                {restockAlerts.map(item => (\n                                    <li key={item.id} className=\"flex justify-between\">\n                                        <span className=\"truncate\">{item.product.name}</span>\n                                        <span className=\"font-bold text-red-600\">\n                                            {item.quantity} left\n                                        </span>\n                                    </li>\n                                ))}\n                            </ul>\n                        )}\n                    </div>\n\n                    {/* RECENT PRODUCTS */}\n                    <div className=\"bg-white p-6 rounded-xl border\">\n                        <h3 className=\"font-semibold mb-4\">Recent Products</h3>\n                        <ul className=\"space-y-3 text-sm\">\n                            {recentProducts.map(item => (\n                                <li key={item.id} className=\"flex justify-between\">\n                                    <span className=\"truncate\">{item.product.name}</span>\n                                    <span className=\"text-gray-500\">\n                                        {item.quantity} units\n                                    </span>\n                                </li>\n                            ))}\n                        </ul>\n                    </div>\n                </div>\n\n                {/* TOP 10 LOW STOCK */}\n                <div className=\"bg-white p-6 rounded-xl border\">\n                    <h3 className=\"font-semibold mb-4 flex items-center gap-2\">\n                        <AlertTriangle className=\"h-5 w-5 text-yellow-500\" />\n                        Top 10 Low Stock Products\n                    </h3>\n\n                    <div className=\"space-y-3 text-sm\">\n                        {topLowStock.map(item => {\n                            const burn = burnRate.find(b => b.product === item.product.name);\n                            return (\n                                <div key={item.id} className=\"flex justify-between\">\n                                    <span className=\"truncate\">{item.product.name}</span>\n                                    <span className=\"font-semibold text-yellow-600\">\n                                        {item.quantity} left\n                                        {burn?.daysLeft !== null\n                                            ? ` (~${burn.daysLeft} days)`\n                                            : \"\"}\n                                    </span>\n                                </div>\n                            );\n                        })}\n                    </div>\n                </div>\n\n            </main>\n        </div>\n    );\n}\n\n/* -----------------------------\n   REUSABLE COMPONENTS\n----------------------------- */\n\nfunction KPI({ title, value, icon, color }: any) {\n    return (\n        <div className=\"bg-white p-6 rounded-xl border flex justify-between items-center\">\n            <div>\n                <p className=\"text-sm text-gray-500\">{title}</p>\n                <h2 className=\"text-2xl font-bold\">{value}</h2>\n            </div>\n            <div className={`text-${color}-600`}>{icon}</div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 523, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/Desktop/Inventory/my-app/src/components/sidebar.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/Inventory/my-app/src/components/sidebar.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,6SAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAuT,GACpV,qFACA","ignoreList":[0]}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/components/sidebar.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/Desktop/Inventory/my-app/src/components/sidebar.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/Desktop/Inventory/my-app/src/components/sidebar.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,6SAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","ignoreList":[0]}},
    {"offset": {"line": 551, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 559, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/stack/server.tsx"],"sourcesContent":["import \"server-only\";\n\nimport { StackServerApp } from \"@stackframe/stack\";\nimport { stackClientApp } from \"./client\";\n\nexport const stackServerApp = new StackServerApp({\n  inheritsFrom: stackClientApp,\n});\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;;;;AAEO,MAAM,iBAAiB,IAAI,yQAAc,CAAC;IAC/C,cAAc,8KAAc;AAC9B"}},
    {"offset": {"line": 576, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/auth.ts"],"sourcesContent":["import { stackServerApp } from \"@/stack/server\";\nimport { redirect } from \"next/navigation\";\n\n\nexport async function getCurrentUser() {\n    const user = await stackServerApp.getUser()\n    if (!user) {\n        redirect(\"/sign-in\");\n    }\n\n    return user;\n}"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAGO,eAAe;IAClB,MAAM,OAAO,MAAM,8KAAc,CAAC,OAAO;IACzC,IAAI,CAAC,MAAM;QACP,IAAA,sOAAQ,EAAC;IACb;IAEA,OAAO;AACX"}},
    {"offset": {"line": 598, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../generated/prisma/client'\n\nconst connectionString = `${process.env.DATABASE_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,4MAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,yLAAY,CAAC;IAAE;AAAQ"}}]
}