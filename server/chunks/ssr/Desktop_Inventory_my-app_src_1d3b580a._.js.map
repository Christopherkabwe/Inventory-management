{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/reports/stockReport.ts"],"sourcesContent":["import { prisma } from '@/lib/prisma';\r\n\r\nexport async function generateStockReport() {\r\n    const inventories = await prisma.inventory.findMany({\r\n        include: {\r\n            product: {\r\n                include: {\r\n                    productions: true,\r\n                    adjustments: true,\r\n                    transfersFrom: true,\r\n                    transfersTo: true,\r\n                },\r\n            },\r\n            location: true,\r\n            sales: true,\r\n        },\r\n    });\r\n\r\n    const report = inventories.map(inv => {\r\n        const product = inv.product;\r\n        const location = inv.location;\r\n\r\n        const salesQty = inv.sales.filter(s => !s.isReturn)\r\n            .reduce((acc, s) => acc + s.quantity, 0);\r\n\r\n        const returnsQty = inv.sales.filter(s => s.isReturn)\r\n            .reduce((acc, s) => acc + s.quantity, 0);\r\n\r\n        const ibtIssued = product.transfersFrom\r\n            .filter(t => t.fromLocationId === location.id)\r\n            .reduce((acc, t) => acc + t.quantity, 0);\r\n\r\n        const ibtReceived = product.transfersTo\r\n            .filter(t => t.toLocationId === location.id)\r\n            .reduce((acc, t) => acc + t.quantity, 0);\r\n\r\n        const stockRecdFromProduction = product.productions.reduce((acc, p) => acc + p.quantity, 0);\r\n\r\n        const rebaggingGain = product.adjustments\r\n            .filter(adj => adj.locationId === location.id && adj.type === \"REBAG_GAIN\")\r\n            .reduce((acc, adj) => acc + adj.quantity, 0);\r\n\r\n        const openingStock = inv.quantity;\r\n\r\n        const closingStock = openingStock + stockRecdFromProduction + returnsQty + ibtReceived + rebaggingGain - salesQty - ibtIssued;\r\n\r\n        return {\r\n            productName: product.name,\r\n            location: location.name,\r\n            stockOpening: openingStock,\r\n            stockRecdDepots: stockRecdFromProduction,\r\n            returns: returnsQty,\r\n            stockRecdFromProdn: stockRecdFromProduction,\r\n            ibtRec: ibtReceived,\r\n            ibtIssued: ibtIssued,\r\n            rebaggingGain: rebaggingGain,\r\n            salesQty: salesQty,\r\n            closingStock: closingStock,\r\n            physicalStock: null, // optional manual input\r\n            difference: null,    // optional: physicalStock - closingStock\r\n        };\r\n    });\r\n\r\n    return report;\r\n}"],"names":[],"mappings":";;;;AAAA;;;;;;AAEO,eAAe;IAClB,MAAM,cAAc,MAAM,mKAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;QAChD,SAAS;YACL,SAAS;gBACL,SAAS;oBACL,aAAa;oBACb,aAAa;oBACb,eAAe;oBACf,aAAa;gBACjB;YACJ;YACA,UAAU;YACV,OAAO;QACX;IACJ;IAEA,MAAM,SAAS,YAAY,GAAG,CAAC,CAAA;QAC3B,MAAM,UAAU,IAAI,OAAO;QAC3B,MAAM,WAAW,IAAI,QAAQ;QAE7B,MAAM,WAAW,IAAI,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,CAAC,EAAE,QAAQ,EAC7C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,aAAa,IAAI,KAAK,CAAC,MAAM,CAAC,CAAA,IAAK,EAAE,QAAQ,EAC9C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,YAAY,QAAQ,aAAa,CAClC,MAAM,CAAC,CAAA,IAAK,EAAE,cAAc,KAAK,SAAS,EAAE,EAC5C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,cAAc,QAAQ,WAAW,CAClC,MAAM,CAAC,CAAA,IAAK,EAAE,YAAY,KAAK,SAAS,EAAE,EAC1C,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAE1C,MAAM,0BAA0B,QAAQ,WAAW,CAAC,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,EAAE,QAAQ,EAAE;QAEzF,MAAM,gBAAgB,QAAQ,WAAW,CACpC,MAAM,CAAC,CAAA,MAAO,IAAI,UAAU,KAAK,SAAS,EAAE,IAAI,IAAI,IAAI,KAAK,cAC7D,MAAM,CAAC,CAAC,KAAK,MAAQ,MAAM,IAAI,QAAQ,EAAE;QAE9C,MAAM,eAAe,IAAI,QAAQ;QAEjC,MAAM,eAAe,eAAe,0BAA0B,aAAa,cAAc,gBAAgB,WAAW;QAEpH,OAAO;YACH,aAAa,QAAQ,IAAI;YACzB,UAAU,SAAS,IAAI;YACvB,cAAc;YACd,iBAAiB;YACjB,SAAS;YACT,oBAAoB;YACpB,QAAQ;YACR,WAAW;YACX,eAAe;YACf,UAAU;YACV,cAAc;YACd,eAAe;YACf,YAAY;QAChB;IACJ;IAEA,OAAO;AACX"}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/app/reports/page.ts"],"sourcesContent":["import { generateStockReport } from \"@/app/reports/stockReport\";\r\n\r\nasync function main() {\r\n    const report = await generateStockReport();\r\n\r\n    console.log(\"Stock Report:\");\r\n    console.table(report);  // easy view in console\r\n}\r\n\r\nmain()\r\n    .catch(e => console.error(e))\r\n    .finally(() => process.exit());\r\n"],"names":[],"mappings":";AAAA;;;;;;AAEA,eAAe;IACX,MAAM,SAAS,MAAM,IAAA,gMAAmB;IAExC,QAAQ,GAAG,CAAC;IACZ,QAAQ,KAAK,CAAC,SAAU,uBAAuB;AACnD;AAEA,OACK,KAAK,CAAC,CAAA,IAAK,QAAQ,KAAK,CAAC,IACzB,OAAO,CAAC,IAAM,QAAQ,IAAI"}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/CHRISTOPHER%20KABWE/Desktop/Inventory/my-app/src/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaPg } from '@prisma/adapter-pg'\nimport { PrismaClient } from '../generated/prisma/client'\n\nconst connectionString = `${process.env.DATABASE_URL}`\n\nconst adapter = new PrismaPg({ connectionString })\nconst prisma = new PrismaClient({ adapter })\n\nexport { prisma };"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,4MAAQ,CAAC;IAAE;AAAiB;AAChD,MAAM,SAAS,IAAI,yLAAY,CAAC;IAAE;AAAQ"}}]
}